cmake_minimum_required(VERSION 3.16)

project(msample, VERSION 0.0.9 LANGUAGES CXX)

message(STATUS "cmake curren source dir: ${CMAKE_CURRENT_SOURCE_DIR}")

# set list of object files generated by m compiler to be built in c
set(OBJS
  ${CMAKE_CURRENT_SOURCE_DIR}/sample_lib.o
)

# specify they are object files
set_source_files_properties(
    ${OBJS} PROPERTIES
    EXTERNAL_OBJECT TRUE  # Identifies this as an object file
    GENERATED TRUE  # Avoids need for file to exist at configure-time
)

# include source files and object files
add_executable(msample
  ${OBJS}
  sample_main.cc
)


link_directories(
  ${CMAKE_CURRENT_SOURCE_DIR}
)

TARGET_LINK_LIBRARIES(msample PRIVATE mlrl)

add_custom_command(
  TARGET msample
  POST_BUILD
  COMMAND msample
  COMMAND npm test
)

