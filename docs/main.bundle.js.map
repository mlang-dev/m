{"version":3,"file":"main.bundle.js","mappings":"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","sources":["webpack://m/external node-commonjs \"fs\"","webpack://m/external node-commonjs \"path\"","webpack://m/webpack/bootstrap","webpack://m/webpack/runtime/make namespace object","webpack://m/./docs_src/mw.ts","webpack://m/./docs_src/main.ts","webpack://m/./docs_src/wasi.ts","webpack://m/./docs_src/zoom.ts"],"sourcesContent":["module.exports = require(\"fs\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export type MInstance = {\n\tmw_instance: WebAssembly.Instance,\n\tversion: string\n\trun_code: any, \n\tcompile: any,\n\tcanvas_id:string,\n\ttext_id:string,\n};\n\ntype MExports = {\n\tmalloc:CallableFunction,\n\tfree:CallableFunction,\n\tcompile_code:CallableFunction,\n\tget_code_size:CallableFunction,\n\tget_version: CallableFunction,\n\tstrlen:CallableFunction,\n\n\tputchar: CallableFunction,\n\tprint: CallableFunction,\n\tpow: CallableFunction,\n\tlog: CallableFunction,\n\tlog2: CallableFunction,\n\tmemory:WebAssembly.Memory,\n\n\t__stack_pointer: any\n};\n\nexport type RunResult = {\n\tstart_result: any,\n\tcode_instance: WebAssembly.Instance,\n\tcode_bytes: any\n};\n\nvar m_instance:MInstance;\nvar m_exports:MExports;\nexport function mw(wasi_env:any, module_name:string, print_func:CallableFunction, is_remote_file:boolean, set_image_data:CallableFunction|null) : Promise<MInstance> {\n\tvar code_instance = null;\n\tvar print_func = print_func;\n\tvar version:string;\n\tvar module:Promise<WebAssembly.WebAssemblyInstantiatedSource>;\n\tif (is_remote_file){\n\t\tmodule = WebAssembly.instantiateStreaming(fetch(module_name), \n\t\t{ \n\t\t\t\"wasi_snapshot_preview1\": wasi_env\n\t\t});\n\t}else{\n\t\t/* for nodejs use */\n\t\tconst fs = require('fs');\n\t\tconst path = require(\"path\");\n\t\tconst wasmBuffer = fs.readFileSync(path.resolve(__dirname, module_name));\n\t\tmodule = WebAssembly.instantiate(wasmBuffer, { \"wasi_snapshot_preview1\": wasi_env });\t\t\n\t}\n\tlet result = new Promise<MInstance>(function (resolve, reject) {\n\t\t// \"Producing Code\" (May take some time)\n\t\tmodule.then(function (obj) {\n\t\t\tm_instance = {\n\t\t\t\trun_code: run_code, \n\t\t\t\tcompile: compile,\n\t\t\t\tversion: version,\n\t\t\t\tmw_instance: obj.instance,\n\t\t\t\tcanvas_id: '',\n\t\t\t\ttext_id: ''\n\t\t\t};\n\t\t\tm_exports = {\n\t\t\t\tmalloc: obj.instance.exports.malloc as CallableFunction,\n\t\t\t\tfree: obj.instance.exports.free as CallableFunction,\n\t\t\t\tcompile_code: obj.instance.exports.compile_code as CallableFunction,\n\t\t\t\tget_code_size: obj.instance.exports.get_code_size as CallableFunction,\n\t\t\t\tget_version: obj.instance.exports.version as CallableFunction,\n\t\t\t\tstrlen: obj.instance.exports.strlen as CallableFunction,\n\n\t\t\t\tputchar: obj.instance.exports.putchar as CallableFunction,\n\t\t\t\tprint: obj.instance.exports.print as CallableFunction,\n\t\t\t\tpow: obj.instance.exports.pow as CallableFunction,\n\t\t\t\tlog: obj.instance.exports.log as CallableFunction,\n\t\t\t\tlog2: obj.instance.exports.log2 as CallableFunction,\n\n\t\t\t\tmemory: obj.instance.exports.memory as WebAssembly.Memory,\n\n\t\t\t\t__stack_pointer: obj.instance.exports.__stack_pointer\n\t\t\t}\n\t\t\tinit_module();\n\t\t\tresolve(m_instance); //when success\n\t\t}).catch(function (reason) {\n\t\t\treject(reason); //when failure\n\t\t});\n\t});\n\t\n\treturn result;\n\n\tfunction init_module() : void\n\t{\n\t\twasi_env.setEnv(m_exports.memory, print_func);\n\t\tif(m_exports.get_version){\n\t\t\tlet c_str = m_exports.get_version();\n\t\t\tversion = to_js_str(c_str);\n\t\t\tm_exports.free(c_str);\n\t\t}\n\t}\n\n\tfunction to_js_str(c_str:any) : string\n\t{\n\t\tconst str_len = m_exports.strlen(c_str)\t\n\t\tlet ta = new Uint8Array(m_exports.memory.buffer, c_str, str_len)\n\t\treturn (new TextDecoder()).decode(ta)\n\t}\n\n\tfunction str_to_ab(str:any, c_str:any) : void\n\t{\n\t\tlet ta = (new TextEncoder()).encode(str) //Uint8Array\n\t\tlet str_len = ta.length + 1;\n\t\tlet dst = new Uint8Array(m_exports.memory.buffer, c_str, str_len)\n\t\tdst.set(ta);\n\t\tdst[ta.length] = 0;\n\t}\n\n\tfunction setImageData(data:any, width:number, height:number) : void\n\t{\n\t\tif(set_image_data != null && set_image_data != undefined){\n\t\t\tlet u8_array = new Uint8ClampedArray(m_exports.memory.buffer, data, width * height * 4);\n\t\t\tset_image_data(u8_array, width, height);\n\t\t}\n\t}\n\n\tfunction run_wasm_code(wasm:any, wasm_size:number) : RunResult\n\t{\n\t\tlet ta = new Uint8Array(m_exports.memory.buffer, wasm, wasm_size);\n\t\tvar compiled = new WebAssembly.Module(ta);\n\t\tconst __memory_base = new WebAssembly.Global({value: \"i32\", mutable: false}, 64 * 1024);\n\t\tcode_instance = new WebAssembly.Instance(compiled, \n\t\t\t{ \n\t\t\t\tsys: \n\t\t\t\t{ \n\t\t\t\t\tprint: m_exports.print,\n\t\t\t\t\tputchar: m_exports.putchar,\n\t\t\t\t\tmemory: m_exports.memory,\n\t\t\t\t\t__memory_base: __memory_base,\n\t\t\t\t\t__stack_pointer: m_exports.__stack_pointer,\n\t\t\t\t\tsetImageData: setImageData\n\t\t\t\t},\n\t\t\t\tmath:{\n\t\t\t\t\tpow: m_exports.pow,\n\t\t\t\t\tlog2: m_exports.log2,\n\t\t\t\t\tlog: m_exports.log\n\t\t\t\t}\n\t\t\t});\n\t\tlet code_start_func = code_instance.exports._start as CallableFunction;\n\t\treturn { \n\t\t\tstart_result: code_start_func(),\n\t\t\tcode_instance: code_instance,\n\t\t\tcode_bytes: wasm\n\t\t};\n\t}\n\n\tfunction run_code(code:string, release_wasm_memory=true) : RunResult | null\n\t{\n\t\tif (!m_instance) {\n\t\t\tprint_func(\"m loading is failed.\");\n\t\t\treturn null;\n\t\t}\n\t\tlet new_ptr = m_exports.malloc(10*1024);\n\t\tstr_to_ab(code, new_ptr);\n\t\tlet wasm = m_exports.compile_code(new_ptr);\n\t\tlet wasm_size = m_exports.get_code_size();\n\t\tif(!wasm_size){\n\t\t\treturn null;\n\t\t}\n\t\tlet result = run_wasm_code(wasm, wasm_size);\n\t\tif(release_wasm_memory){\n\t\t\tm_exports.free(wasm);\n\t\t\t//result = result.start_result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction compile(code:string, file_path:string) : void\n\t{\n\t\tlet new_ptr = m_exports.malloc(1024);\n\t\tstr_to_ab(code, new_ptr);\n\t\tlet wasm = m_exports.compile_code(new_ptr);\n\t\tlet wasm_size = m_exports.get_code_size();\n\t\tif(!wasm_size){\n\t\t\treturn undefined;\n\t\t}\n\t\tlet ta = new Uint8Array(m_exports.memory.buffer, wasm, wasm_size);\n\t\tconst fs = require('fs');\n\t\tfs.writeFileSync(file_path, ta, 'binary');\n\t\tm_exports.free(wasm);\n\t}\n}\n","import { wasi } from './wasi';\nimport { mw, MInstance, RunResult } from './mw';\nimport { initZoom, Zoom } from './zoom';\n\nvar instance:MInstance;\nvar runResult:RunResult;\nvar zoom: Zoom | null = null;\n\nfunction set_image_data(data:any, width:number, height:number)\n{\n    let canvasDom = document.getElementById(instance.canvas_id) as HTMLCanvasElement;\n    if(!canvasDom) return;\n    let ctx = canvasDom.getContext('2d');\n    if(!ctx) return;\n    canvasDom.width = width;\n    canvasDom.height = height;\n    let imageData = ctx.createImageData(width, height);\n    imageData.data.set(data);\n    ctx.putImageData(imageData, 0, 0);\n}\n\nmw(wasi(), '/mw.wasm', print, true, set_image_data).then(\n    result=>{\n        instance = result;\n        print_version(\"version\", instance.version);\n    }\n);\n\nfunction run(code_id:string)\n{\n    let result_text_id = code_id + \"_result\";\n    let result_graph_id = code_id + \"_graph_result\";\n    clear(result_text_id, result_graph_id);\n    if(runResult != undefined && runResult.code_bytes != undefined){\n        const free = instance.mw_instance.exports.free as CallableFunction;\n        free(runResult.code_bytes);\n    }\n    let code = (document.getElementById(code_id) as HTMLInputElement).value;\n    instance.canvas_id = result_graph_id;   \n    instance.text_id = result_text_id;     \n    runResult = instance.run_code(code, false);\n    print(runResult.start_result);\n    if(!zoom) return;\n    zoom.init();\n    update_back_forward();\n}\n\nfunction update_back_forward()\n{\n    if(!zoom) return;\n    (document.getElementById('backward') as HTMLButtonElement).disabled = zoom.cur_pos <= 0;\n    (document.getElementById('forward') as HTMLButtonElement).disabled = zoom.cur_pos >= zoom.history.length - 1;\n}\n        \nfunction print(text:string){\n    let textDom = document.getElementById(instance.text_id);\n    if(!textDom){\n        console.log(\"missing textDom: \", instance.text_id);\n        return;\n    }\n    textDom.textContent += text;\n}\n\nfunction clear(result_text_id:string, result_canvas_id:string){\n    let textDom = document.getElementById(result_text_id);\n    let canvasDom = document.getElementById(result_canvas_id) as HTMLCanvasElement;\n    if(textDom)\n        textDom.textContent = '';\n    if(!canvasDom) return;\n    const ctx = canvasDom.getContext('2d');\n    if(!ctx) return;\n    ctx.clearRect(0, 0, canvasDom.width, canvasDom.height);\n}\n\nfunction print_version(version_id:string, version:string) {\n    let versionDom = document.getElementById(version_id);\n    if(!versionDom) return;\n    versionDom.textContent = version;\n}\n\nwindow.onload = function() {\n    var runs = document.querySelectorAll(\"button[data-run]\");\n    runs.forEach((runBtn)=>{\n        let runDom = runBtn as HTMLElement;\n        runDom.addEventListener(\"click\", \n        event => {\n            run(runDom.dataset.run || '');\n        });\n    });\n    \n    var codeDom = document.getElementById(\"code\") as HTMLInputElement;\n    if(!codeDom) return;\n    codeDom.addEventListener('keydown', function(e) {\n    if (e.key == 'Tab') {\n        e.preventDefault();\n        let start = codeDom.selectionStart || 0;\n        let end = codeDom.selectionEnd || 0;\n\n        // set textarea value to: text before caret + tab + text after caret\n        codeDom.value = codeDom.value.substring(0, start) +\n        \"\\t\" + codeDom.value.substring(end);\n\n        // put caret at right position again\n        codeDom.selectionStart =\n            codeDom.selectionEnd = start + 1;\n    }\n    });\n    var backward = document.getElementById(\"backward\") as HTMLButtonElement;\n    var forward = document.getElementById(\"forward\") as HTMLButtonElement;\n\n    backward.addEventListener('click', \n        function ()\n        {\n            if(!zoom) return;\n            zoom.backward();\n        });\n\n    forward.addEventListener('click', \n        function ()\n        {\n            if(!zoom) return;\n            zoom.forward();\n        }\n    );\n\n    function onZoom(x0:number, y0:number, x1:number, y1:number)\n    {\n        const plot_mandelbrot_set = runResult.code_instance.exports.plot_mandelbrot_set as CallableFunction;\n        plot_mandelbrot_set(x0, y0, x1, y1);\n        update_back_forward();\n    }\n\n    let canvas_container = document.getElementById('canvas_container');\n    if(canvas_container)\n        zoom = initZoom(canvas_container, onZoom, -2.0, -1.2, 1.0, 1.2, 400, 300);\n    update_back_forward();\n    var code_text = \n    `print \"plot a mandelbrot set\"\n\nlet plot_mandelbrot_set x0:f64 y0:f64 x1:f64 y1:f64 =\n\tlet width = 400, height = 300\n\tvar a:u8[height][width * 4]\n\tlet scalex = (x1-x0)/width, scaley = (y1-y0)/height, max_iter = 510\n\tvar v = 0.0, r = 0.0, g = 0.0, b = 0.0\n\tfor x in 0..width\n\t\tfor y in 0..height\n\t\t\tlet cx = x0 + scalex*x\n\t\t\tlet cy = y0 + scaley*y\n\t\t\tvar zx = 0.0, zy = 0.0\n\t\t\tvar zx2 = 0.0, zy2 = 0.0\n\t\t\tvar n = 0\n\t\t\twhile n<max_iter && (zx2 + zy2) < 4.0\n\t\t\t\tzy = 2.0 * zx * zy + cy\n\t\t\t\tzx = zx2  - zy2 + cx\n\t\t\t\tzx2 = zx * zx\n\t\t\t\tzy2 = zy * zy\n\t\t\t\tn++\n\t\t\tif n < max_iter then\n\t\t\t\tv = (log(n+1.5-(log2((log(zx2+zy2))/2.0))))/3.4\n\t\t\t\tif v < 1.0 then \n\t\t\t\t\tr = v ** 4;g = v ** 2.5;b = v\n\t\t\t\telse\n\t\t\t\t\tv = v < 2.0 ? 2.0 - v : 0.0\n\t\t\t\t\tr = v;g = v ** 1.5;b = v ** 3.0\n\t\t\ta[y][4*x] = n == max_iter ? 0 : (u8)(r * 255)\n\t\t\ta[y][4*x+1] = n == max_iter ? 0 : (u8)(g * 255)\n\t\t\ta[y][4*x+2] = n == max_iter ? 0 : (u8)(b * 255)\n\t\t\ta[y][4*x+3] = 255\n\n\tsetImageData a width height\n\nplot_mandelbrot_set (-2.0) (-1.2) 1.0 1.2\n`;\n    codeDom.value = code_text;\n};\n\n","export type WASI = {\n    setEnv: any,\n    environ_sizes_get: any,\n    args_sizes_get: any,\n    fd_prestat_get: any,\n    fd_fdstat_get: any,\n    fd_write: any,\n    fd_prestat_dir_name: any,\n    environ_get: any,\n    args_get: any,\n    poll_oneoff: any,\n    proc_exit: any,\n    fd_close: any,\n    fd_seek: any\n};\n\nexport function wasi() : WASI\n{\n    var memory:WebAssembly.Memory;\n    var printf:CallableFunction;\n    var WASI_ESUCCESS = 0;\n    var WASI_EBADF = 8;\n    var WASI_EINVAL = 28;\n    var WASI_ENOSYS = 52;\n\n    var WASI_STDOUT_FILENO = 1;\n\n    function setEnv(mem:WebAssembly.Memory, print_func:CallableFunction) {\n\n        memory = mem;\n        printf = print_func;\n    }\n\n    function getModuleMemoryDataView() {\n        // call this any time you'll be reading or writing to a module's memory \n        // the returned DataView tends to be dissaociated with the module's memory buffer at the will of the WebAssembly engine \n        // cache the returned DataView at your own peril!!\n\n        return new DataView(memory.buffer);\n    }\n\n    function fd_prestat_get(fd:any, bufPtr:any) {\n\n        return WASI_EBADF;\n    }\n\n    function fd_prestat_dir_name(fd:any, pathPtr:any, pathLen:any) {\n\n        return WASI_EINVAL;\n    }\n\n    function environ_sizes_get(environCount:any, environBufSize:any) {\n\n        var view = getModuleMemoryDataView();\n\n        view.setUint32(environCount, 0, !0);\n        view.setUint32(environBufSize, 0, !0);\n\n        return WASI_ESUCCESS;\n    }\n\n    function environ_get(environ:any, environBuf:any) {\n\n        return WASI_ESUCCESS;\n    }\n\n    function args_sizes_get(argc:any, argvBufSize:any) {\n\n        var view = getModuleMemoryDataView();\n\n        view.setUint32(argc, 0, !0);\n        view.setUint32(argvBufSize, 0, !0);\n\n        return WASI_ESUCCESS;\n    }\n\n    function args_get(argv:any, argvBuf:any) {\n\n        return WASI_ESUCCESS;\n    }\n\n    function fd_fdstat_get(fd:any, bufPtr:any) {\n\n        var view = getModuleMemoryDataView();\n\n        view.setUint8(bufPtr, fd);\n        view.setUint16(bufPtr + 2, 0, !0);\n        view.setUint16(bufPtr + 4, 0, !0);\n\n        function setBigUint64(byteOffset:any, value:any, littleEndian:any) {\n\n            var lowWord = value;\n            var highWord = 0;\n\n            view.setUint32(littleEndian ? 0 : 4, lowWord, littleEndian);\n            view.setUint32(littleEndian ? 4 : 0, highWord, littleEndian);\n        }\n\n        setBigUint64(bufPtr + 8, 0, !0);\n        setBigUint64(bufPtr + 8 + 8, 0, !0);\n\n        return WASI_ESUCCESS;\n    }\n\n    function utf8_to_string(array:any) {\n        var out, i, len, c;\n        var char2, char3;\n\n        out = \"\";\n        len = array.length;\n        i = 0;\n        while (i < len) {\n            c = array[i++];\n            switch (c >> 4) {\n                case 0: case 1: case 2: case 3: case 4: case 5: case 6: case 7:\n                    // 0xxxxxxx\n                    out += String.fromCharCode(c);\n                    break;\n                case 12: case 13:\n                    // 110x xxxx   10xx xxxx\n                    char2 = array[i++];\n                    out += String.fromCharCode(((c & 0x1F) << 6) | (char2 & 0x3F));\n                    break;\n                case 14:\n                    // 1110 xxxx  10xx xxxx  10xx xxxx\n                    char2 = array[i++];\n                    char3 = array[i++];\n                    out += String.fromCharCode(((c & 0x0F) << 12) |\n                        ((char2 & 0x3F) << 6) |\n                        ((char3 & 0x3F) << 0));\n                    break;\n            }\n        }\n        return out;\n    }    \n\n    function fd_write(fd:any, iovs:any, iovsLen:any, nwritten:any) {\n\n        var view = getModuleMemoryDataView();\n\n        var written = 0;\n        var bufferBytes:any[] = [];\n\n        function getiovs(iovs:any, iovsLen:any) {\n            // iovs* -> [iov, iov, ...]\n            // __wasi_ciovec_t {\n            //   void* buf,\n            //   size_t buf_len,\n            // }\n            var buffers = Array.from({ length: iovsLen }, function (_, i) {\n                var ptr = iovs + i * 8;\n                var buf = view.getUint32(ptr, !0);\n                var bufLen = view.getUint32(ptr + 4, !0);\n\n                return new Uint8Array(memory.buffer, buf, bufLen);\n            });\n\n            return buffers;\n        }\n        var buffers = getiovs(iovs, iovsLen);\n        function writev(iov:any) {\n\n            for (var b = 0; b < iov.byteLength; b++) {\n\n                bufferBytes.push(iov[b]);\n            }\n            written += b;\n        }\n\n        buffers.forEach(writev);\n\n        if (fd === WASI_STDOUT_FILENO) {\n            printf(utf8_to_string(bufferBytes));\n        }\n\n        view.setUint32(nwritten, written, !0);\n\n        return WASI_ESUCCESS;\n    }\n\n    function poll_oneoff(sin:any, sout:any, nsubscriptions:any, nevents:any) {\n\n        return WASI_ENOSYS;\n    }\n\n    function proc_exit(rval:any) {\n\n        return WASI_ENOSYS;\n    }\n\n    function fd_close(fd:any) {\n\n        return WASI_ENOSYS;\n    }\n\n    function fd_seek(fd:any, offset:any, whence:any, newOffsetPtr:any) {\n\n    }\n\n    return {\n        setEnv: setEnv,\n        environ_sizes_get: environ_sizes_get,\n        args_sizes_get: args_sizes_get,\n        fd_prestat_get: fd_prestat_get,\n        fd_fdstat_get: fd_fdstat_get,\n        fd_write: fd_write,\n        fd_prestat_dir_name: fd_prestat_dir_name,\n        environ_get: environ_get,\n        args_get: args_get,\n        poll_oneoff: poll_oneoff,\n        proc_exit: proc_exit,\n        fd_close: fd_close,\n        fd_seek: fd_seek\n    }\n}\n","export type RectValue = {\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number\n};\n\nexport type Zoom = {\n    history: Array<RectValue>,\n    cur_pos: number,\n    init: CallableFunction,\n    backward: CallableFunction,\n    forward: CallableFunction\n};\n\nexport function initZoom(canvas:HTMLElement, onZoom:CallableFunction, x0:number, y0:number, x1:number, y1:number, width:number, height:number) : Zoom\n{\n    function setMousePosition(e:any) {  \n        mouse.x = e.clientX;\n        mouse.y = e.clientY;\n    };\n\n    var mouse = {\n        x: 0,\n        y: 0,\n        startX: 0,\n        startY: 0\n    };\n    var element:HTMLElement | null = null;\n    var _width = width;\n    var _height = height;\n    var _x0 = x0;\n    var _y0 = y0;\n    var _x1 = x1;\n    var _y1 = y1;\n    var _is_init = false;\n    var zoom = {\n        history: Array<RectValue>(),\n        cur_pos: -1,\n        init: init,\n        backward: backward,\n        forward: forward\n    };\n\n    canvas.onmousemove = onZoomMove;\n    canvas.ontouchmove = onTouchMove;\n    canvas.ontouchstart = onTouchStart;\n    canvas.ontouchend = onTouchEnd;\n\n    function onTouchMove(e:any)\n    {\n        if(e.touches.length != 1) return;\n        onZoomMove(e.touches[0]);\n    }\n\n    function onTouchStart(e:any)\n    {\n        if(e.touches.length != 1) return;\n        onZoomStart(e.touches[0]);\n    }\n\n    function onTouchEnd(e:any)\n    {\n        onZoomEnd(null);\n    }\n\n    function init()\n    {\n        _is_init = true;\n        zoom.history = [];\n        zoom.cur_pos = -1;\n        save_current();\n    }\n\n    function save_current(){\n        let items_to_remove = zoom.history.length - 1 - zoom.cur_pos;\n        for (let i = 0; i < items_to_remove; i++) {\n            zoom.history.pop();\n        }\n        zoom.history.push({x0: _x0, y0: _y0, x1: _x1, y1: _y1});\n        zoom.cur_pos += 1;\n    }\n\n    function backward(){\n        if(zoom.cur_pos > 0){\n            zoom.cur_pos -= 1;\n            refresh();\n        }\n    }\n\n    function forward(){\n        if(zoom.cur_pos < zoom.history.length - 1){\n            zoom.cur_pos += 1;\n            refresh();\n        }\n    }\n\n    function refresh()\n    {\n        let cur_zoom = zoom.history[zoom.cur_pos];\n        _x0 = cur_zoom.x0;\n        _y0 = cur_zoom.y0;\n        _x1 = cur_zoom.x1;\n        _y1 = cur_zoom.y1;\n        onZoom(_x0, _y0, _x1, _y1);\n    }\n\n    function onZoomStart(e:any)\n    {\n        setMousePosition(e);\n        mouse.startX = mouse.x;\n        mouse.startY = mouse.y;\n        element = document.createElement('div');\n        element.className = 'rectangle'\n        element.style.left = mouse.x + 'px';\n        element.style.top = mouse.y + 'px';\n        canvas.appendChild(element)\n        canvas.style.cursor = \"crosshair\";\n    }\n\n    function onZoomMove(e:any){\n        setMousePosition(e);\n        if (element !== null) {\n            element.style.width = Math.abs(mouse.x - mouse.startX) + 'px';\n            element.style.height = Math.abs(mouse.y - mouse.startY) + 'px';\n            let left = mouse.x < mouse.startX ? mouse.x : mouse.startX;\n            let top = mouse.y < mouse.startY ? mouse.y : mouse.startY;\n            left += window.pageXOffset;\n            top += window.pageYOffset;\n            element.style.left = left + 'px';\n            element.style.top = top + 'px';\n        }\n    }\n\n    function onZoomCancel(e:any)\n    {\n        if(!element) return;\n        canvas.removeChild(element);\n        element = null;\n    }\n\n    function onZoomEnd(e:any)\n    {\n        if(!element) return;\n        canvas.removeChild(element);\n        element = null;\n        canvas.style.cursor = \"default\";\n        var rect = canvas.getBoundingClientRect();\n        var x0 = Math.min(mouse.startX, mouse.x) - rect.left;\n        var y0 = Math.min(mouse.startY, mouse.y) - rect.top;\n        var x1 = Math.max(mouse.startX, mouse.x) - rect.left;\n        var y1 = Math.max(mouse.startY, mouse.y) - rect.top;\n        var scalex = (_x1 - _x0) / _width; \n        var scaley = (_y1 - _y0) / _height; \n        let _cx0 = _x0;\n        let _cy0 = _y0;\n        _x0 = _cx0 + scalex * x0;\n        _y0 = _cy0 + scaley * y0;\n        _x1 = _cx0 + scalex * x1;\n        _y1 = _cy0 + scaley * y1; \n        save_current();\n        onZoom(_x0, _y0, _x1, _y1); \n    }\n\n    canvas.onclick = function (e) {\n        if(!_is_init) return;\n        if(e.which == 3){\n            onZoomCancel(e);\n            return;\n        }\n        if (element !== null) {\n            onZoomEnd(e);\n        } else {\n            onZoomStart(e);\n        }\n    }\n    return zoom;\n}\n"],"names":["module","exports","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","r","Symbol","toStringTag","Object","defineProperty","value","m_instance","m_exports","instance","runResult","zoom","update_back_forward","document","getElementById","disabled","cur_pos","history","length","print","text","textDom","text_id","textContent","console","log","wasi_env","module_name","print_func","is_remote_file","set_image_data","version","code_instance","WebAssembly","instantiateStreaming","fetch","Promise","resolve","reject","then","obj","run_code","compile","mw_instance","canvas_id","malloc","free","compile_code","get_code_size","get_version","strlen","putchar","pow","log2","memory","__stack_pointer","setEnv","c_str","str_len","ta","Uint8Array","buffer","TextDecoder","decode","to_js_str","init_module","catch","reason","str_to_ab","str","TextEncoder","encode","dst","set","setImageData","data","width","height","u8_array","Uint8ClampedArray","code","release_wasm_memory","new_ptr","wasm","wasm_size","result","compiled","Module","__memory_base","Global","mutable","start_result","code_start_func","Instance","sys","math","_start","code_bytes","run_wasm_code","file_path","writeFileSync","mw","printf","getModuleMemoryDataView","DataView","mem","environ_sizes_get","environCount","environBufSize","view","setUint32","args_sizes_get","argc","argvBufSize","fd_prestat_get","fd","bufPtr","fd_fdstat_get","setBigUint64","byteOffset","littleEndian","lowWord","setUint8","setUint16","fd_write","iovs","iovsLen","nwritten","written","bufferBytes","Array","from","_","i","ptr","buf","getUint32","bufLen","getiovs","forEach","iov","b","byteLength","push","array","out","len","c","char2","char3","String","fromCharCode","utf8_to_string","fd_prestat_dir_name","pathPtr","pathLen","environ_get","environ","environBuf","args_get","argv","argvBuf","poll_oneoff","sin","sout","nsubscriptions","nevents","proc_exit","rval","fd_close","fd_seek","offset","whence","newOffsetPtr","wasi","canvasDom","ctx","getContext","imageData","createImageData","putImageData","version_id","versionDom","print_version","window","onload","querySelectorAll","runBtn","runDom","addEventListener","event","code_id","result_text_id","result_graph_id","result_canvas_id","clearRect","clear","init","run","dataset","codeDom","e","key","preventDefault","start","selectionStart","end","selectionEnd","substring","backward","forward","canvas_container","canvas","onZoom","x0","y0","x1","y1","setMousePosition","mouse","x","clientX","y","clientY","startX","startY","element","_width","_height","_x0","_y0","_x1","_y1","_is_init","save_current","refresh","items_to_remove","pop","cur_zoom","onZoomStart","createElement","className","style","left","top","appendChild","cursor","onZoomMove","Math","abs","pageXOffset","pageYOffset","onZoomEnd","removeChild","rect","getBoundingClientRect","min","max","scalex","scaley","_cx0","_cy0","onmousemove","ontouchmove","touches","ontouchstart","ontouchend","onclick","which","initZoom","plot_mandelbrot_set"],"sourceRoot":""}