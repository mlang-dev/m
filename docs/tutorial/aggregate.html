<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>m | succinct, expressive and efficient programming</title>
		<script src="/wasi.js"></script>
		<script src="/mw.js"></script>
		<link rel="stylesheet" href="/simple.css">
		<link rel="stylesheet" href="/style.css">
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
		<link rel="manifest" href="/site.webmanifest">
	</head>
	<body>
		<header>
		<nav>
			<a href="/">M</a>
			<a class="current">Tutorials</a>
			<a href="/grammar.html">Grammar</a>
			<a href="https://github.com/ligangwang/m"><svg class="icon" viewBox="0 0 32 32">
					<path
						d="M16 0.395c-8.836 0-16 7.163-16 16 0 7.069 4.585 13.067 10.942 15.182 0.8 0.148 1.094-0.347 1.094-0.77 0-0.381-0.015-1.642-0.022-2.979-4.452 0.968-5.391-1.888-5.391-1.888-0.728-1.849-1.776-2.341-1.776-2.341-1.452-0.993 0.11-0.973 0.11-0.973 1.606 0.113 2.452 1.649 2.452 1.649 1.427 2.446 3.743 1.739 4.656 1.33 0.143-1.034 0.558-1.74 1.016-2.14-3.554-0.404-7.29-1.777-7.29-7.907 0-1.747 0.625-3.174 1.649-4.295-0.166-0.403-0.714-2.030 0.155-4.234 0 0 1.344-0.43 4.401 1.64 1.276-0.355 2.645-0.532 4.005-0.539 1.359 0.006 2.729 0.184 4.008 0.539 3.054-2.070 4.395-1.64 4.395-1.64 0.871 2.204 0.323 3.831 0.157 4.234 1.026 1.12 1.647 2.548 1.647 4.295 0 6.145-3.743 7.498-7.306 7.895 0.574 0.497 1.085 1.47 1.085 2.963 0 2.141-0.019 3.864-0.019 4.391 0 0.426 0.288 0.925 1.099 0.768 6.354-2.118 10.933-8.113 10.933-15.18 0-8.837-7.164-16-16-16z">
					</path>
				</svg>Github</a>
		</nav>
		</header>
		<script>
			var instance = null;
			var result_control = null;
			mw(new wasi(), '/mw.wasm', print, true).then(
				result=>{
					instance = result;
					print_version(instance.version);
				}
			);
			function run(code_control) {
				result_control = code_control + "_result";
				clear();
				let code = document.getElementById(code_control).value;
				print(instance.run_code(code));
			}
			
			function print(text){
				if(text == null || text == undefined){
					return;
				}
				document.getElementById(result_control).textContent = text;
			}

			function clear(){
				document.getElementById(result_control).textContent = '';
			}
			function print_version(version) {
				document.getElementById("version").textContent = version;
			}
		</script>

        <nav>
            
<a href="/tutorial/general.html">general</a>
<a href="/tutorial/operators.html">operators</a>
<a href="/tutorial/control.html">control</a>
<a class="current">aggregate</a>
<a href="/tutorial/reference.html">reference</a>
        </nav>
    </p>
    
    <div>struct and array are aggregate types in m. Their data are stored on the stack by default. M uses call-by-value convention to pass arguments
to the called function. Struct type in m is a value type. When the passed argument is struct type, the struct data is duplicated and 
its reference/address is passed to the function. This is to prevent the struct value is being changed by the callee.

Array type is a reference type in m. When you assign an array object to a variable, only its address is assigned to the variable. The operation is 
super efficlient and this is in contrast to struct type assignment, where its contents are copied to the assigned variable.</div>
    
                <div>
complex cf64 is a builtin struct type defined as "struct cf64 = re:f64, im:f64", the example below shows
how to initialize a struct type variable and how to access field of the struct type variable.
</div>
                <div style="margin-top: 10px;">
                    <textarea id="cf64_re"  rows = "2" style="resize: none;">z = cf64 { 10.0, 20.0 }
z.re</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('cf64_re')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "cf64_re_result"></div>
                </div>
                
                <div>
use keyword "struct" to define a struct type</div>
                <div style="margin-top: 10px;">
                    <textarea id="struct_with_different_types"  rows = "3" style="resize: none;">struct A = x:int, y:f64
a = A { 10, 20.0 }
a.y</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('struct_with_different_types')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "struct_with_different_types_result"></div>
                </div>
                
                <div>
use keyword "union" to define a union type</div>
                <div style="margin-top: 10px;">
                    <textarea id="union_with_different_types"  rows = "3" style="resize: none;">union A = x:int | y:int
a = A { 10 }
a.y</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('union_with_different_types')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "union_with_different_types_result"></div>
                </div>
                
                <div>access struct initializer's field without using a variable</div>
                <div style="margin-top: 10px;">
                    <textarea id="access_field_no_var"  rows = "2" style="resize: none;">struct A = x:int, y:f64
A { 10, 20.0 }.y</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('access_field_no_var')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "access_field_no_var_result"></div>
                </div>
                
                <div>
Struct could be nested. Here we embed struct cf64 inside struct AB.
</div>
                <div style="margin-top: 10px;">
                    <textarea id="struct_in_struct"  rows = "3" style="resize: none;">struct AB = a:cf64, b:cf64
ab = AB {cf64{10.0, 20.0}, cf64 { 30.0, 40.0 }}
ab.b.im</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('struct_in_struct')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "struct_in_struct_result"></div>
                </div>
                
                <div>
return a nesting struct from a function
</div>
                <div style="margin-top: 10px;">
                    <textarea id="return_struct_in_struct"  rows = "3" style="resize: none;">struct AB = a:cf64, b:cf64
let get () = AB{cf64{10.0, 20.0}, cf64{30.0, 40.0}}
get().b.im</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('return_struct_in_struct')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "return_struct_in_struct_result"></div>
                </div>
                
                <div>
We define struct AB as two fields, each of which is also a cf64 struct. The following code is 
initializing a struct AB object and return one of field a to the caller.
</div>
                <div style="margin-top: 10px;">
                    <textarea id="return_field_from_struct"  rows = "5" style="resize: none;">struct AB = a:cf64, b:cf64
let get () = 
    ab = AB{cf64{10.0, 20.0}, cf64{30.0, 40.0}}
    ab.a
get().im</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('return_field_from_struct')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "return_field_from_struct_result"></div>
                </div>
                
                <div>
One more time, but this time we eliminate a variable in the function.
</div>
                <div style="margin-top: 10px;">
                    <textarea id="return_field_struct"  rows = "3" style="resize: none;">struct AB = a:cf64, b:cf64
let get () = AB{cf64{10.0, 20.0}, cf64{30.0, 40.0}}.a
get().re</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('return_field_struct')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "return_field_struct_result"></div>
                </div>
                
                <div>pass a struct and return a new struct to the caller then print the field of returned struct</div>
                <div style="margin-top: 10px;">
                    <textarea id="pass_return_struct"  rows = "3" style="resize: none;">let add z:cf64 op:f64 = cf64{z.re + op, z.im + op}
x = cf64{10.0, 20.0}
(add x 10.0).im</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('pass_return_struct')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "pass_return_struct_result"></div>
                </div>
                
                <div>pass a struct and return a new struct the caller without any temp variable</div>
                <div style="margin-top: 10px;">
                    <textarea id="pass_return_struct_no_variable"  rows = "2" style="resize: none;">let add z:cf64 op:f64 = cf64 { z.re + op, z.im + op }
(add (cf64 { 10.0, 20.0 }) 10.0).re</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('pass_return_struct_no_variable')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "pass_return_struct_no_variable_result"></div>
                </div>
                
                <div>struct member assign struct</div>
                <div style="margin-top: 10px;">
                    <textarea id="struct_member_assign_struct"  rows = "5" style="resize: none;">struct xy = x:f64, y:f64
struct wz = var w:f64, z:xy
ab = wz{10.0, xy{20.0, 30.0}}
ab.z = xy{200.0, 300.0}
ab.z.y</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('struct_member_assign_struct')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "struct_member_assign_struct_result"></div>
                </div>
                
                <div>variable scope</div>
                <div style="margin-top: 10px;">
                    <textarea id="variable_scope"  rows = "3" style="resize: none;">struct wz = w:f64, z:f64
z = wz { 10.0, 20.0 }
z.z</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('variable_scope')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "variable_scope_result"></div>
                </div>
                
                <div>
use field of struct in expression.
</div>
                <div style="margin-top: 10px;">
                    <textarea id="cf64_expr"  rows = "2" style="resize: none;">z = cf64 { 10.0, 20.0 }
z.re + z.im</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('cf64_expr')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "cf64_expr_result"></div>
                </div>
                
                <div>
Here we define a function returning a struct type cf64 and assign it to variable x.
</div>
                <div style="margin-top: 10px;">
                    <textarea id="return_struct"  rows = "3" style="resize: none;">let z() = cf64 { 10.0, 20.0 }
x = z()
x.re + x.im</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('return_struct')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "return_struct_result"></div>
                </div>
                
                <div>
We can directly access return of function call without assigning a variable.
</div>
                <div style="margin-top: 10px;">
                    <textarea id="return_struct_no_var"  rows = "2" style="resize: none;">let z() = cf64 { 10.0, 20.0 }
z().im</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('return_struct_no_var')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "return_struct_no_var_result"></div>
                </div>
                
                <div>
We can pass struct argument to a function.
</div>
                <div style="margin-top: 10px;">
                    <textarea id="pass_struct"  rows = "3" style="resize: none;">let im z:cf64 = z.im
x = cf64 { 10.0, 20.0 }
im x</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('pass_struct')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "pass_struct_result"></div>
                </div>
                
                <div>
We can pass struct argument directly without a variable to a function.
</div>
                <div style="margin-top: 10px;">
                    <textarea id="pass_struct_no_var"  rows = "2" style="resize: none;">let im z:cf64 = z.im
im (cf64 { 10.0, 20.0 })</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('pass_struct_no_var')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "pass_struct_no_var_result"></div>
                </div>
                
                <div>
Pass the struct data, and return with expression using one field
</div>
                <div style="margin-top: 10px;">
                    <textarea id="pass_struct_add_one_value"  rows = "3" style="resize: none;">let im z:cf64 = 
    z.im + 200.0
im (cf64 { 10.0, 20.0 })</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('pass_struct_add_one_value')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "pass_struct_add_one_value_result"></div>
                </div>
                
                <div>
Pass the struct data, and return with a struct with new value
</div>
                <div style="margin-top: 10px;">
                    <textarea id="pass_struct_add_value"  rows = "4" style="resize: none;">let shift z:cf64 = 
    cf64{z.re + 100.0, z.im + 200.0}
result = shift (cf64 { 10.0, 20.0 })
result.re + result.im</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('pass_struct_add_value')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "pass_struct_add_value_result"></div>
                </div>
                
                <div>struct member assign</div>
                <div style="margin-top: 10px;">
                    <textarea id="struct_member_assign"  rows = "4" style="resize: none;">struct Point = var x:f64, y:f64
z = Point { 10.0, 20.0 }
z.x = 30.0
z.x</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('struct_member_assign')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "struct_member_assign_result"></div>
                </div>
                
                <div>
initialize a 1 length of int array
</div>
                <div style="margin-top: 10px;">
                    <textarea id="one_element_array_init"  rows = "2" style="resize: none;">a = [10]
a[0]</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('one_element_array_init')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "one_element_array_init_result"></div>
                </div>
                
                <div>
initialize a two elements of int array
</div>
                <div style="margin-top: 10px;">
                    <textarea id="more_array_element"  rows = "2" style="resize: none;">a = [10, 20]
a[0]</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('more_array_element')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "more_array_element_result"></div>
                </div>
                
                <div>
sum a two elements of int array
</div>
                <div style="margin-top: 10px;">
                    <textarea id="sum_of_elements"  rows = "2" style="resize: none;">a = [10, 20]
a[0] + a[1]</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('sum_of_elements')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "sum_of_elements_result"></div>
                </div>
                
                <div>
update the first element of an array
</div>
                <div style="margin-top: 10px;">
                    <textarea id="update_array_element"  rows = "3" style="resize: none;">a = [10]
a[0] = 20
a[0]</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('update_array_element')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "update_array_element_result"></div>
                </div>
                
                <div>
update the second element of an array
</div>
                <div style="margin-top: 10px;">
                    <textarea id="update_second_element"  rows = "3" style="resize: none;">a = [10,20]
a[1] = 200
a[0] + a[1]</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('update_second_element')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "update_second_element_result"></div>
                </div>
                
                <div>
declare a u8 array
</div>
                <div style="margin-top: 10px;">
                    <textarea id="u8_array"  rows = "2" style="resize: none;">a:u8[2] = [10, 20]
a[0] + a[1]</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('u8_array')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "u8_array_result"></div>
                </div>
                
                <div>
declare a u8 array
</div>
                <div style="margin-top: 10px;">
                    <textarea id="u8_array_update"  rows = "4" style="resize: none;">a:u8[2] = [10, 20]
a[0] = 30
a[1] = 40
a[0] + a[1]</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('u8_array_update')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "u8_array_update_result"></div>
                </div>
                
                <div>
declare a u8 two dimensions array
</div>
                <div style="margin-top: 10px;">
                    <textarea id="u8_two_dimension_array"  rows = "2" style="resize: none;">a:u8[2][2] = [10, 20, 30, 40]
a[1][1]</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('u8_two_dimension_array')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "u8_two_dimension_array_result"></div>
                </div>
                
                <div>
update two dimensions array
</div>
                <div style="margin-top: 10px;">
                    <textarea id="u8_two_dimen_update"  rows = "3" style="resize: none;">a:u8[2][2] = [10, 20, 30, 40]
a[1][1] = 100
a[1][1]</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('u8_two_dimen_update')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "u8_two_dimen_update_result"></div>
                </div>
                
                <div>
update two dimensions array using variable
</div>
                <div style="margin-top: 10px;">
                    <textarea id="u8_access_via_var"  rows = "5" style="resize: none;">a:u8[10][10]
for i in 0..10
    for j in 0..10
        a[i][j] = i + j
a[7][8]</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('u8_access_via_var')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "u8_access_via_var_result"></div>
                </div>
                
                <div>
update two dimensions int array using variable
</div>
                <div style="margin-top: 10px;">
                    <textarea id="u32_access_via_var"  rows = "5" style="resize: none;">a:u32[10][10]
for i in 0..10
    for j in 0..10
        a[i][j] = i + j
a[7][8]</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('u32_access_via_var')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "u32_access_via_var_result"></div>
                </div>
                
                <div>
pass array variable to a function.
</div>
                <div style="margin-top: 10px;">
                    <textarea id="pass_array_to_a_function"  rows = "6" style="resize: none;">a:u8[10][10]
for i in 0..10
    for j in 0..10
        a[i][j] = i + j
let pick arr:u8[10][10] x:int y:int = arr[x][y]
pick a 9 8</textarea>
                </div>
                <div>
                    <div style="display: inline-block; margin-right:5px;"><button type="button" onclick="run('pass_array_to_a_function')" style="min-width: 50px;">run</button></div>
                    <div style="display: inline-block; margin-left:5px;" id= "pass_array_to_a_function_result"></div>
                </div>
                	<!-----------------footer----------------->
	<footer>
		<label id="version"></label>
		<p>mlang is created by <a href="https://wangs.dev">Ligang Wang</a> and is open sourced under the MIT license.</p>
	</footer>
	</body>
</html>